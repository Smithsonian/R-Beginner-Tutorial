## ----setup, include=FALSE------------------------------------------------
knitr::opts_chunk$set(echo = TRUE, prompt = TRUE, collapse = TRUE)

## ------------------------------------------------------------------------
getwd()

## ---- eval = F-----------------------------------------------------------
## setwd("D:/Jared/work/R/R_LinearRegression")

## ------------------------------------------------------------------------
data(mtcars)

## ------------------------------------------------------------------------
head(mtcars, 10)

## ------------------------------------------------------------------------
str(mtcars)

## ------------------------------------------------------------------------
summary(mtcars)

## ------------------------------------------------------------------------
plot(mtcars)

## ---- echo = F-----------------------------------------------------------
paste("The slope is negative")

## ------------------------------------------------------------------------
plot(mtcars$mpg ~ mtcars$wt)

## ------------------------------------------------------------------------
plot(mtcars$mpg ~ mtcars$wt, xlab="Weight", ylab="MPG", main="MPG vs Weight")

## ------------------------------------------------------------------------
cor(mtcars$mpg, mtcars$wt)
cor.test(mtcars$mpg, mtcars$wt)

## ------------------------------------------------------------------------
head(mtcars)
my_mtcars <- mtcars[, -c(8,9)]
head(my_mtcars, 10) 

## ------------------------------------------------------------------------
my_mtcars <- subset(my_mtcars, select = -c(gear, carb))

## ------------------------------------------------------------------------
str(my_mtcars)
dim(my_mtcars)

## ------------------------------------------------------------------------
my_mtcars$cyl <- as.factor(my_mtcars$cyl)
class(my_mtcars$cyl)

## ------------------------------------------------------------------------
tapply(my_mtcars$mpg, my_mtcars$cyl, mean)

## ------------------------------------------------------------------------
par(mfrow=c(1, 2))
boxplot(my_mtcars$mpg, main = "mpg")
boxplot(my_mtcars$wt, main = "weight")  

## ------------------------------------------------------------------------
boxplot.stats(my_mtcars$wt)$out

## ------------------------------------------------------------------------
my_mtcars <- subset(my_mtcars, wt <= 5.3)

## ------------------------------------------------------------------------
lm1 <- lm(mpg ~ wt, data = my_mtcars)

## ------------------------------------------------------------------------
summary(lm1)

## ------------------------------------------------------------------------
par(mfrow=c(1, 1))
plot(mpg ~ wt, data = my_mtcars)
abline(lm1, col="blue")

## ---- eval = F-----------------------------------------------------------
## abline(coef = lm1$coefficients, col="green")
## abline(lm1$coefficients, col="red")

## ------------------------------------------------------------------------
lm2 <- lm(mpg ~ wt + hp, data = my_mtcars)
lm3 <- lm(mpg ~ hp, data = my_mtcars)
summary(lm2)
summary(lm3)

## ------------------------------------------------------------------------
AIC(lm1)
AIC(lm2)
AIC(lm3)

## ------------------------------------------------------------------------
nd <- data.frame(hp = 225, wt = 4.0)
predict(lm2, newdata = nd, type = "response")

## ------------------------------------------------------------------------
lm2$coefficients[[1]] + (lm2$coefficients[[2]]*4.0) + (lm2$coefficients[[3]]*225)

